<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>For You üíñ | Heart Maze</title>
  <style>
    :root{
      --bg: #fff2f6;
      --primary: #ff4d6d;
      --accent: #ff8fab;
      --text: #3a3a3a;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Arial,sans-serif;color:var(--text)}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:20px}

    .card{width:min(92vw,520px);background:#fff;border-radius:22px;box-shadow:0 10px 30px rgba(255,77,109,.18);padding:16px 16px 22px}
    .title{display:flex;gap:8px;align-items:center;justify-content:center;font-weight:800;font-size:clamp(18px,3.6vw,24px);margin:6px 0 10px}
    .subtitle{opacity:.75;text-align:center;margin:0 0 10px}

    /* Play area */
    .area{position:relative;margin:10px auto;width:100%;aspect-ratio:1/1;border-radius:20px;background:radial-gradient(40% 40% at 50% 30%, #ffe3ea 0%, #ffd3df 50%, #ffc2d2 100%);overflow:hidden;touch-action:none}

    /* Heart background using inline SVG overlay */
    .heart-bg{position:absolute;inset:6% 6%;}
    .heart-bg svg{width:100%;height:100%;display:block}

    /* Player and goal */
    .piece{position:absolute;user-select:none;touch-action:none;}
    #player{font-size:34px;line-height:1;filter:drop-shadow(0 6px 16px rgba(255,77,109,.35));cursor:grab}
    #player:active{cursor:grabbing}
    #goal{font-size:38px;line-height:1;transition:transform .25s ease;filter:drop-shadow(0 6px 16px rgba(255,77,109,.25))}
    #goal.win{transform:scale(1.22)}

    /* Walls */
    .wall{
      position:absolute;
      background:crimson;
      border-radius:4px;
    }
    .wall1{ top:40%; left:30%; width:53%; height:8px; }   /* horizontal wall */
    .wall2{ top:30%; left:60%; width:8px; height:36%; }   /* vertical wall */

    .bar{display:flex;justify-content:center;gap:8px;margin-top:12px}
    .btn{appearance:none;border:0;background:var(--primary);color:#fff;padding:10px 14px;border-radius:14px;cursor:pointer;font-weight:700;box-shadow:0 10px 30px rgba(255,77,109,.2)}

    /* Modal */
    .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.45);z-index:20}
    .modal.show{display:grid}
    .panel{background:#fff;border-radius:20px;max-width:min(92vw,460px);padding:18px;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,.18)}
    .panel h2{margin:6px 0 8px}
    .actions{display:flex;justify-content:center;gap:10px;margin-top:10px}
    .yes{background:linear-gradient(180deg,var(--primary),#ff5e7c)}
    .no{background:#e9e9e9;color:#333}
    .wall {
  z-index: 1;   /* walls stay below */
}
#goal.center-animate {
  position: absolute;
  left: 50% !important;
  top: 50% !important;
  transform: translate(-50%, -50%) scale(5);
  transition: all 1s ease-in-out;
  z-index: 9999; /* stays on top */
}


   
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="title">A Little Game for You üíñ</div>
      <p class="subtitle">Drag the heart to the envelope to reveal my letter <br>Don‚Äôt hit the walls!</p>

      <div id="area" class="area">
        <!-- Decorative heart background -->
        <div class="heart-bg" aria-hidden="true">
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="g" x1="0" x2="1" y1="0" y2="1">
                <stop offset="0%" stop-color="#ffd9e6"/>
                <stop offset="100%" stop-color="#ffc1d2"/>
              </linearGradient>
            </defs>
            <path d="M50 18 C40 6 14 10 10 33 C7 51 22 64 50 82 C78 64 93 51 90 33 C86 10 60 6 50 18 Z"
                  fill="url(#g)" stroke="#ffffff" stroke-width="1.5" />
          </svg>
        </div>

        <!-- Player and goal -->
        <div id="player" class="piece" style="left: 42%; top: 76%;">‚ù§Ô∏è</div>
        <div id="goal" class="piece" style="left: 68%; top: 12%;">üíå</div>

        <!-- Two maze walls -->
        <div class="wall wall1"></div>
        <div class="wall wall2"></div>
      </div>

      <div class="bar">
        <button id="reset" class="btn">Restart ‚Üª</button>
      </div>
    </div>
  </div>

  <!-- Proposal modal -->
  <div id="proposal" class="modal" role="dialog" aria-modal="true">
    <div class="panel">
      <h2>Found my way to you üíñ</h2>
      <p>Every turn led me here. Will you be my girlfriend?</p>
      <div class="actions">
        <button class="btn yes" id="yesBtn">Yes üíñ</button>
        <button class="btn no" id="noBtn">No üò¢</button>
      </div>
    </div>
  </div>

  <script>
    const area = document.getElementById('area');
    const player = document.getElementById('player');
    const goal = document.getElementById('goal');
    const resetBtn = document.getElementById('reset');
    const walls = document.querySelectorAll('.wall');

    // Ensure we can drag with finger or mouse
    let dragging = false; let pointerId = null; let offsetX=0, offsetY=0;

    function getBounds(el){ return el.getBoundingClientRect(); }
    function clamp(n, min, max){ return Math.max(min, Math.min(n, max)); }
    function placePlayer(leftPct, topPct){
      player.style.left = leftPct + '%';
      player.style.top = topPct + '%';
    }

    function resetHeart(){
      goal.classList.remove('win');
      placePlayer(42, 76);
    }

function checkWin(){
  const a = getBounds(player);
  const b = getBounds(goal);
  const overlap = !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);
  if(overlap){
    // Add animation class
    goal.classList.add('center-animate');

    // After animation, redirect to letter page
    setTimeout(()=>{
      window.location.href = "letter.html";
    }, 1200); // matches animation duration
  }
}



    function checkWalls(){
      const a = getBounds(player);
      walls.forEach(wall=>{
        const b = getBounds(wall);
        const hit = !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);
        if(hit){ resetHeart(); }
      });
    }

    player.addEventListener('pointerdown', (e)=>{
      dragging = true; pointerId = e.pointerId; player.setPointerCapture(pointerId);
      const pr = getBounds(player);
      offsetX = e.clientX - pr.left; offsetY = e.clientY - pr.top;
    });

    area.addEventListener('pointermove', (e)=>{
      if(!dragging || (pointerId!==null && e.pointerId!==pointerId)) return;
      const ar = getBounds(area);
      const pw = player.offsetWidth; const ph = player.offsetHeight;
      let x = e.clientX - ar.left - offsetX;
      let y = e.clientY - ar.top - offsetY;
      x = clamp(x, 0, ar.width - pw);
      y = clamp(y, 0, ar.height - ph);
      player.style.left = x + 'px';
      player.style.top = y + 'px';
      checkWin();
      checkWalls();
    });

    function endDrag(e){
      if(pointerId!==null){ try{ player.releasePointerCapture(pointerId); }catch(_){} }
      dragging = false; pointerId = null;
    }

    area.addEventListener('pointerup', endDrag);
    area.addEventListener('pointercancel', endDrag);
    area.addEventListener('pointerleave', endDrag);

    resetBtn.addEventListener('click', ()=>{
      resetHeart();
      document.getElementById('proposal').classList.remove('show');
    });

    document.getElementById('yesBtn').addEventListener('click', ()=>{
      const p = document.querySelector('#proposal .panel');
      p.innerHTML = `<h2>Yay! üíû</h2><p>You just made me the happiest person.</p><div class="actions"><button class="btn yes" onclick="location.reload()">Play again</button></div>`;
    });

    document.getElementById('noBtn').addEventListener('click', ()=>{
      const panel = document.querySelector('#proposal .panel');
      panel.animate([{transform:'translateX(0)'},{transform:'translateX(-8px)'},{transform:'translateX(8px)'},{transform:'translateX(0)'}],{duration:250});
    });
  </script>
</body>
</html>
